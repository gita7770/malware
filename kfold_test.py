if __name__ == "__main__":
    """ Seeding """
    np.random.seed(42)
    tf.random.set_seed(42)

    """ Paths """
    dataset_path = "/content/drive/MyDrive/Malnet"
    model_base_path = os.path.join("files", "model_fold_{}.h5")

    """ Dataset """
    images = load_data(dataset_path)
    test_x = [images[i] for i in range(len(images)) if i not in train_index and i not in val_index]
    test_ds = tf_dataset(test_x, batch=hp["batch_size"])

    """ Model """
    for fold in range(5):
        model_path = model_base_path.format(fold+1)
        model = ViT(hp)
        model.load_weights(model_path)
        model.compile(
            loss=tf.keras.losses.CategoricalCrossentropy(from_logits=False),
            optimizer=tf.keras.optimizers.Adam(hp["lr"]),
            metrics=["acc"]
        )

        print(f"Evaluating fold {fold+1}")
        model.evaluate(test_ds)
